<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>New Dubai International Airport - DATABASE</title>
  <style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(to right, #a8e6cf, #dcedc1, #ff8a80); /* Gradiente suave de cores mais claras */
    color: #333; /* Texto mais escuro para melhor contraste */
    margin: 0;
    padding: 0;
    font-size: 13px;
  }

  .tabs {
    display: flex;
    background: #ffeb3b; /* Amarelo mais claro para a barra de navega√ß√£o */
    flex-wrap: wrap;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }

  .tab {
    flex: 1;
    text-align: center;
    padding: 12px;
    cursor: pointer;
    color: #ffffff; /* Texto das abas em branco */
    background: #ffeb3b; /* Fundo amarelo vibrante para as abas */
    border-bottom: 2px solid transparent;
    transition: background 0.3s, border-bottom 0.3s;
  }

  .tab:hover {
    background: #fbc02d; /* Cor amarela mais vibrante ao passar o mouse */
  }

  .tab.active {
    color: #fff;
    border-bottom: 2px solid #00e5ff; /* Cor azul clara na parte de baixo da aba ativa */
    background: #fbc02d; /* Fundo mais dourado para a aba ativa */
  }

  input, button, textarea, select {
    padding: 10px;
    margin: 5px 0;
    width: 100%;
    border-radius: 6px;
    border: 1px solid #444;
    background-color: #ffffff; /* Fundo branco para campos de entrada */
    color: #333; /* Cor do texto nos campos em cinza escuro */
  }

  button {
    background: linear-gradient(to right, #ff9800, #ff5722); /* Gradiente vibrante para o bot√£o */
    color: white;
    font-weight: bold;
    border: none;
    cursor: pointer;
    transition: transform 0.2s ease;
  }

  button:hover {
    transform: scale(1.05); /* Efeito de aumento ao passar o mouse */
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
    border: 1px solid #ccc;
    box-shadow: 0 0 10px rgba(0,0,0,0.2); /* Sombra suave ao redor da tabela */
  }

  th, td {
    padding: 8px 10px;
    border: 1px solid #ddd; /* Borda mais clara para as c√©lulas */
    text-align: left;
    background: #f9fbe7; /* Fundo claro para as c√©lulas da tabela */
    color: #333; /* Cor do texto nas c√©lulas */
  }

  th {
    background: #ffeb3b; /* Cor de fundo amarela para os cabe√ßalhos */
    color: #fff;
    font-weight: bold;
  }

  .remove-btn {
    background: #ff4e50; /* Cor vibrante para o bot√£o de remover */
    border: none;
    color: white;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
  }

  .remove-btn:hover {
    background: #e43e3e; /* Cor vermelha mais intensa quando o mouse passa */
  }

  img.logo {
    height: 30px;
    vertical-align: middle;
    margin-right: 8px;
  }

  td.logo-cell {
    background-color: #fff;
    padding: 5px;
    border-radius: 4px;
    text-align: center;
    width: 70px;
    min-width: 70px;
    max-width: 70px;
  }

  td.logo-cell img {
    width: 60px;
    max-height: 40px;
    object-fit: contain;
  }
</style>


</head>
<body>
  <div class="tabs">
    <div class="tab active" onclick="trocarAba(0)">üõ¨ Chegadas</div>
    <div class="tab" onclick="trocarAba(1)">üõ´ Partidas</div>
    <div class="tab" onclick="trocarAba(2)">‚ûï Novo Voo</div>
    <div class="tab" onclick="trocarAba(3)">üíæ Backup</div>
  </div>

  <div class="tab-content active" id="aba-chegadas">
    <label>Filtrar por Companhia A√©rea:</label>
    <select id="filter-companhia" onchange="filtrar()">
      <option value="">Selecione</option>
    </select>
    <label>Filtrar por Destino:</label>
    <select id="filter-destino" onchange="filtrar()">
      <option value="">Selecione</option>
    </select>
    <label>Filtrar por Pa√≠s:</label>
    <select id="filter-pais" onchange="filtrar()">
      <option value="">Selecione</option>
    </select>
    <label>Filtrar por TPS:</label>
    <select id="filter-tps" onchange="filtrar()">
      <option value="">Selecione</option>
    </select>
    <div id="chegadasTabela"></div>
  </div>
  <div class="tab-content" id="aba-partidas">
    <label>Filtrar por Companhia A√©rea:</label>
    <select id="filter-companhia-partidas" onchange="filtrar()">
      <option value="">Selecione</option>
    </select>
    <label>Filtrar por Destino:</label>
    <select id="filter-destino-partidas" onchange="filtrar()">
      <option value="">Selecione</option>
    </select>
    <label>Filtrar por Pa√≠s:</label>
    <select id="filter-pais-partidas" onchange="filtrar()">
      <option value="">Selecione</option>
    </select>
    <label>Filtrar por TPS:</label>
    <select id="filter-tps-partidas" onchange="filtrar()">
      <option value="">Selecione</option>
    </select>
    <div id="partidasTabela"></div>
  </div>
  <div class="tab-content" id="aba-novo">
    <label>Companhia A√©rea:</label><input id="companhia" placeholder="Ex: AIR FRANCE" type="text"/>
    <label>Cidade (Destino):</label><input id="cidade" placeholder="Ex: Paris" type="text"/>
    <label>C√≥digo ICAO:</label><input id="icao" placeholder="Ex: LFPG" type="text"/>
    <label>Pa√≠s:</label><input id="pais" placeholder="Ex: Fran√ßa" type="text"/>
    <label>Voo (Flight):</label><input id="voo" placeholder="Ex: 01234" type="text"/>
    <label>Hor√°rio (Time):</label><input id="horario" placeholder="Ex: 14:35" type="text"/>
    <label>Aeronave (A/C):</label><input id="aeronave" placeholder="Ex: A320" type="text"/>
    <label>Status:</label><input id="status" placeholder="Ex: Confirmado" type="text"/>
    <label>TPS:</label><input id="tps" placeholder="Ex: TPS1" type="text"/>
    <label>Tipo:</label>
    <select id="tipo">
      <option value="chegada">Chegada</option>
      <option value="partida">Partida</option>
    </select>
    <button onclick="adicionarVoo()">Adicionar</button>
  </div>
  <div class="tab-content" id="aba-backup">
    <button onclick="exportarBackup()">‚¨áÔ∏è Exportar Backup</button>
    <button onclick="document.getElementById('importar').click()">‚¨ÜÔ∏è Importar Backup</button>
    <input accept=".json" id="importar" onchange="importarBackup(event)" style="display:none" type="file"/>
    <textarea id="output" placeholder="Exporta√ß√£o em formato texto"></textarea>
  </div>

  <script>
  let registrosChegadas = JSON.parse(localStorage.getItem('registrosChegadas')) || [];
  let registrosPartidas = JSON.parse(localStorage.getItem('registrosPartidas')) || [];
  
  // Filtragem separada para chegadas e partidas
  let registrosFiltradosChegadas = registrosChegadas;
  let registrosFiltradosPartidas = registrosPartidas;

  // Trocar entre as abas
  function trocarAba(indice) {
    document.querySelectorAll('.tab').forEach((el, i) => el.classList.toggle('active', i === indice));
    document.querySelectorAll('.tab-content').forEach((el, i) => el.classList.toggle('active', i === indice));

    // Resetar a filtragem ao mudar de aba
    if (indice === 0) {
      renderTabela(registrosFiltradosChegadas, 'chegadasTabela');
    } else if (indice === 1) {
      renderTabela(registrosFiltradosPartidas, 'partidasTabela');
    }
  }

  // Renderizar a tabela com os dados filtrados
  function renderTabela(registros, destinoId) {
    // Limpar o conte√∫do da tabela antes de renderizar
    document.getElementById(destinoId).innerHTML = '';
    
    registros.forEach(voo => {
      voo.horario = voo.horario.padStart(5, '0');
    });

    registros.sort((a, b) => {
      const [aHour, aMinute] = a.horario.split(':').map(Number);
      const [bHour, bMinute] = b.horario.split(':').map(Number);
      if (aHour !== bHour) return aHour - bHour;
      return aMinute - bMinute;
    });

    let html = '<table><thead><tr>' +
      '<th>AIRLINES</th><th>FLIGHT</th><th>DESTINATION</th><th>ICAO</th>' +
      '<th>COUNTRY</th><th>TIME</th><th>A/C</th><th>TPS</th><th>STATUS</th><th>ACTION</th>' +
      '</tr></thead><tbody>';

    registros.forEach((e, i) => {
      const logo = `<td class='logo-cell'><img class='logo' src='logos/${normalizarNome(e.companhia)}.png' onerror="this.src='logos/default.png'" title='${e.companhia}'></td>`;
      html += `<tr>
        ${logo}
        <td>${e.voo || ''}</td>
        <td>${e.cidade}</td>
        <td>${e.icao}</td>
        <td>${e.pais}</td>
        <td>${e.horario || ''}</td>
        <td>${e.aeronave || ''}</td>
        <td>${e.tps || ''}</td>
        <td>${e.status || ''}</td>
        <td><button class='remove-btn' onclick='removerVoo(${i}, "${destinoId}")'>‚úñ</button></td>
      </tr>`;
    });

    html += '</tbody></table>';
    document.getElementById(destinoId).innerHTML = html;
  }

  // Fun√ß√£o de normaliza√ß√£o para a cria√ß√£o de logos
  function normalizarNome(nome) {
    return nome.toLowerCase().replace(/[^a-z0-9]/g, "_");
  }

  // Popular os selects para filtros de chegadas e partidas
  function popularSelects() {
    const companhias = [...new Set(registrosChegadas.map(voo => voo.companhia))].sort();
    const destinos = [...new Set(registrosChegadas.map(voo => voo.cidade))].sort();
    const paises = [...new Set(registrosChegadas.map(voo => voo.pais))].sort();
    const tps = [...new Set(registrosChegadas.map(voo => voo.tps))].sort();

    const updateSelectOptions = (selectId, options) => {
      const select = document.getElementById(selectId);
      options.forEach(option => {
        const optionElement = document.createElement('option');
        optionElement.value = option;
        optionElement.textContent = option;
        select.appendChild(optionElement);
      });
    };

    updateSelectOptions('filter-companhia', ['', ...companhias]);
    updateSelectOptions('filter-destino', ['', ...destinos]);
    updateSelectOptions('filter-pais', ['', ...paises]);
    updateSelectOptions('filter-tps', ['', ...tps]);

    updateSelectOptions('filter-companhia-partidas', ['', ...companhias]);
    updateSelectOptions('filter-destino-partidas', ['', ...destinos]);
    updateSelectOptions('filter-pais-partidas', ['', ...paises]);
    updateSelectOptions('filter-tps-partidas', ['', ...tps]);
  }

  // Fun√ß√£o de filtragem para chegadas
  function filtrar() {
    const filtroCompanhia = document.getElementById('filter-companhia').value.toLowerCase();
    const filtroDestino = document.getElementById('filter-destino').value.toLowerCase();
    const filtroPais = document.getElementById('filter-pais').value.toLowerCase();
    const filtroTps = document.getElementById('filter-tps').value.toLowerCase();

    registrosFiltradosChegadas = registrosChegadas.filter(voo =>
      (filtroCompanhia === '' || voo.companhia.toLowerCase().includes(filtroCompanhia)) &&
      (filtroDestino === '' || voo.cidade.toLowerCase().includes(filtroDestino)) &&
      (filtroPais === '' || voo.pais.toLowerCase().includes(filtroPais)) &&
      (filtroTps === '' || voo.tps.toLowerCase().includes(filtroTps))
    );

    renderTabela(registrosFiltradosChegadas, 'chegadasTabela');
    renderTabela(registrosFiltradosPartidas, 'partidasTabela');
  }

  // Fun√ß√£o de filtragem para partidas (similares √†s chegadas)
  function filtrarPartidas() {
    const filtroCompanhia = document.getElementById('filter-companhia-partidas').value.toLowerCase();
    const filtroDestino = document.getElementById('filter-destino-partidas').value.toLowerCase();
    const filtroPais = document.getElementById('filter-pais-partidas').value.toLowerCase();
    const filtroTps = document.getElementById('filter-tps-partidas').value.toLowerCase();

    registrosFiltradosPartidas = registrosPartidas.filter(voo =>
      (filtroCompanhia === '' || voo.companhia.toLowerCase().includes(filtroCompanhia)) &&
      (filtroDestino === '' || voo.cidade.toLowerCase().includes(filtroDestino)) &&
      (filtroPais === '' || voo.pais.toLowerCase().includes(filtroPais)) &&
      (filtroTps === '' || voo.tps.toLowerCase().includes(filtroTps))
    );

    renderTabela(registrosFiltradosChegadas, 'chegadasTabela');
    renderTabela(registrosFiltradosPartidas, 'partidasTabela');
  }

  // Remover voo de uma aba espec√≠fica
  function removerVoo(indice, tipo) {
    if (tipo === 'chegadasTabela') registrosChegadas.splice(indice, 1);
    else registrosPartidas.splice(indice, 1);
    salvarDados();
    atualizarTabelas();
  }

  // Fun√ß√£o de salvar dados
  function salvarDados() {
    localStorage.setItem('registrosChegadas', JSON.stringify(registrosChegadas));
    localStorage.setItem('registrosPartidas', JSON.stringify(registrosPartidas));
  }

  // Atualizar as tabelas com os dados filtrados
  function atualizarTabelas() {
    renderTabela(registrosFiltradosChegadas, 'chegadasTabela');
    renderTabela(registrosFiltradosPartidas, 'partidasTabela');
  }

  window.onload = () => {
    popularSelects();
    atualizarTabelas();
  };
</script>
